<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Météo actuelle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.10/css/weather-icons.min.css">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.10/css/weather-icons-wind.min.css">
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
      background: #eef6ff;
      color: #333;
    }
    .icon {
      font-size: 2rem;
      vertical-align: middle;
      margin-right: 0.5rem;
    }
    .meteo {
      background: white;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: auto;
    }
    h2 {
      text-align: center;
      color: #0077cc;
    }
  </style>
</head>
<body>
  <div class="meteo">
    <h2>Météo actuelle</h2>
    <div id="weather"></div>
  </div>

  <script>
    // Beaufort scale: 0–12
    function windSpeedToBeaufort(speed) {
      const scale = [0.2, 1.5, 3.3, 5.4, 7.9, 10.7, 13.8, 17.1, 20.7, 24.4, 28.4, 32.6];
      for (let i = 0; i < scale.length; i++) {
        if (speed < scale[i]) return i;
      }
      return 12;
    }

    // Conversion en point cardinal
    function degToCardinal(deg) {
      const dirs = ['N','NNE','NE','ENE','E','ESE','SE','SSE','S','SSW','SW','WSW','W','WNW','NW','NNW'];
      return dirs[Math.round(deg / 22.5) % 16];
    }

    async function getWeather() {
      const apiKey = 'TON_API_KEY_OPENWEATHER'; // Remplace avec ta clé OpenWeather
      const lat = 48.8566; // Exemple : Paris
      const lon = 2.3522;

      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=fr&appid=${apiKey}`;
      const res = await fetch(url);
      const data = await res.json();

      const icon = data.weather[0].icon;
      const description = data.weather[0].description;
      const temp = data.main.temp;
      const windDeg = data.wind.deg;
      const windSpeed = data.wind.speed;
      const beaufort = windSpeedToBeaufort(windSpeed);

      const direction = degToCardinal(windDeg);

      const html = `
        <p><img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="${description}" class="icon" />
        ${description}, ${temp.toFixed(1)} °C</p>
        <p>
          <i class="wi wi-wind-beaufort-${beaufort} icon"></i>
          Vent : ${windSpeed.toFixed(1)} m/s (Beaufort ${beaufort})<br/>
          <i class="wi wi-wind towards-${windDeg}-deg icon"></i>
          Direction : ${windDeg}° (${direction})
        </p>
      `;

      document.getElementById('weather').innerHTML = html;
    }

    getWeather();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" /> 
  <title>Laissez votre avis</title>
</head>
<body>
    <button onclick="window.location.href='index.html'">Retour à la page d'accueil</button>
  <h1>Laissez votre avis</h1>
  <form action="/api/avis" method="POST">
    <label>Nom : <input type="text" name="nom" required></label><br><br>
    <label>Message :<br><textarea name="message" rows="5" cols="40" required></textarea></label><br><br>
    <button type="submit">Envoyer</button>
  </form>
<div id="avisList"><em>Chargement des avis...</em></div>

<script>
fetch("http://dubus.free.fr/lire_avis.php")
  .then(response => response.json())
  .then(data => {
    const container = document.getElementById("avisList");
    container.innerHTML = "<h2>Avis laissés :</h2>";
    data.reverse().forEach(avis => {
      const avisDiv = document.createElement("div");
      avisDiv.innerHTML = `
        <p><strong>${avis.nom}</strong> (${new Date(avis.created_at).toLocaleString()}):<br>
        ${avis.message}</p>
        <hr>`;
      container.appendChild(avisDiv);
    });
  })
  .catch(error => {
    document.getElementById("avisList").innerHTML = "Impossible de charger les avis.";
    console.error(error);
  });
</script>

  
</body>
</html>
